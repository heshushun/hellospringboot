webpackJsonp([18],{"7rKr":function(t,e,n){var r=n("OLSO");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n("rjj0")("85510ada",r,!0)},"9tmf":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mvHQ"),i=n.n(r),s=n("vLgD");var a={data:function(){return{hrs:[],msg:"",currentUser:this.$store.state.user,currentFriend:{}}},created:function(){this.loadHrs()},computed:{msgList:{get:function(){return this.$store.state.msgList}},isDotMap:{get:function(){return this.$store.state.isDotMap}}},watch:{msgList:function(){document.getElementById("chatDiv").scrollTop=document.getElementById("chatDiv").scrollHeight}},methods:{sendMsg:function(){var t=window.localStorage.getItem(this.$store.state.user.account+"#"+this.currentFriend.account);if(null==t)(t=[]).push({msg:this.msg,from:this.$store.state.user.account}),window.localStorage.setItem(this.$store.state.user.account+"#"+this.currentFriend.account,i()(t));else{var e=JSON.parse(t);e.push({msg:this.msg,from:this.$store.state.user.account}),window.localStorage.setItem(this.$store.state.user.account+"#"+this.currentFriend.account,i()(e))}this.$store.state.chatStomp.send("/ws/chat",{},this.msg+";"+this.currentFriend.account),this.msg="",this.updateChatDiv()},updateChatDiv:function(){var t=window.localStorage.getItem(this.currentUser.account+"#"+this.currentFriend.account);null===t?this.$store.commit("updateMsgList",[]):this.$store.commit("updateMsgList",JSON.parse(t))},toggleFriend:function(t){t!==this.currentFriend&&(this.currentFriend=t,this.$store.commit("updateCurrentFriend",t),this.updateChatDiv(),this.$store.commit("removeValueDotMap","isDot#"+this.currentUser.account+"#"+t.account),document.getElementById("chatDiv").scrollTop=document.getElementById("chatDiv").scrollHeight)},loadHrs:function(){var t,e=this;Object(s.a)({url:"/user/friend",method:"get",params:t}).then(function(t){e.hrs=t.data})}}},o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-container",[n("el-aside",{attrs:{width:"160px"}},[t._l(t.hrs,function(e,r){return n("div",{key:e.id,staticClass:"friendListDiv",class:{currentChatFriend:t.currentFriend.id==e.id},on:{click:function(n){t.toggleFriend(e)}}},[n("img",{staticClass:"userfaceImg",attrs:{src:e.portrait}}),t._v(" "),n("el-badge",{attrs:{"is-dot":null!=t.isDotMap.get("isDot#"+t.currentUser.account+"#"+e.account)}},[t._v(t._s(e.name))])],1)}),t._v(" "),n("div",{staticStyle:{"background-color":"#20a0ff",height:"1px",width:"160px"}})],2),t._v(" "),n("el-main",{staticStyle:{"padding-top":"0px","padding-bottom":"0px"}},[n("div",{ref:"chatDiv",staticClass:"chatDiv",attrs:{id:"chatDiv"}},[n("p",{directives:[{name:"show",rawName:"v-show",value:t.currentFriend.name,expression:"currentFriend.name"}],staticStyle:{"text-align":"center"}},[t._v("与\n          "),n("el-tag",{staticStyle:{"margin-left":"5px","margin-right":"5px"},attrs:{type:"primary",size:"small"}},[t._v(t._s(t.currentFriend.name)+"\n          ")]),t._v("\n          聊天中\n        ")],1),t._v(" "),t._l(t.msgList,function(e){return[e.from===t.currentFriend.account?n("div",{staticStyle:{display:"flex","justify-content":"flex-start","align-items":"center","box-sizing":"border-box"}},[n("img",{staticClass:"userfaceImg",attrs:{src:t.currentFriend.portrait}}),t._v(" "),n("div",{staticStyle:{display:"inline-flex","border-style":"solid","border-width":"1px","border-color":"#20a0ff","border-radius":"5px",padding:"5px 8px 5px 8px"}},[t._v("\n              "+t._s(e.msg)+"\n            ")])]):t._e(),t._v(" "),e.from!==t.currentFriend.account?n("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"center","box-sizing":"border-box"}},[n("div",{staticStyle:{display:"inline-flex","border-style":"solid","border-width":"1px","border-color":"#20a0ff","border-radius":"5px",padding:"5px 8px 5px 8px","margin-right":"3px","background-color":"#9eea6a"}},[t._v("\n              "+t._s(e.msg)+"\n            ")]),t._v(" "),n("img",{staticClass:"userfaceImg",attrs:{src:t.currentUser.portrait}})]):t._e()]})],2),t._v(" "),n("div",{staticStyle:{"text-align":"left","margin-top":"20px"}},[n("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入内容",size:"mini",type:"textarea",autosize:""},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}}),t._v(" "),n("el-button",{staticClass:"sendBtn",attrs:{disabled:!t.currentFriend.id,size:"small",type:"primary"},on:{click:t.sendMsg}},[n("svg-icon",{staticStyle:{"margin-right":"8px"},attrs:{"icon-class":"guide"}}),t._v("\n          发送\n        ")],1)],1)])],1)],1)},staticRenderFns:[]};var c={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"app-container"},[this._v("\n  系统通知\n")])},staticRenderFns:[]},l={data:function(){return{activeName:"chat"}},methods:{handleClick:function(t,e){console.log(t,e)}},components:{fc:n("VU/8")(a,o,!1,function(t){n("7rKr")},null,null).exports,nf:n("VU/8")(null,c,!1,null,null,null).exports}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-tabs",{staticStyle:{"margin-top":"10px"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"好友聊天",name:"chat"}},[n("fc")],1),t._v(" "),n("el-tab-pane",{attrs:{label:"系统通知",name:"notification"}},[n("nf")],1)],1)],1)},staticRenderFns:[]},u=n("VU/8")(l,d,!1,null,null,null);e.default=u.exports},OLSO:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\n.userfaceImg {\n  width: 37px;\n  height: 37px;\n  border-radius: 30px;\n  margin-right: 10px;\n}\n.friendListDiv {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: start;\n      -ms-flex-pack: start;\n          justify-content: flex-start;\n  padding-left: 20px;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  width: 160px;\n  height: 40px;\n  border-color: #20a0ff;\n  border-left-style: solid;\n  border-top-style: solid;\n  border-right-style: solid;\n  border-width: 1px;\n  cursor: pointer\n}\n.chatDiv {\n  border-color: #20a0ff;\n  border-style: solid;\n  border-radius: 5px;\n  border-width: 1px;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  width: 700px;\n  height: 450px;\n  overflow-y: auto;\n  padding-bottom: 50px;\n}\n.sendBtn {\n  padding-left: 25px;\n  padding-right: 25px\n}\n.currentChatFriend {\n  background-color: #dcdfe6;\n}\n\n",""])}});